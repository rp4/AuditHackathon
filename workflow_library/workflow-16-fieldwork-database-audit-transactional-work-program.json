{
  "name": "Fieldwork: Database Audit - Transactional Work Program",
  "description": "A transactional audit workflow for database security, access control, change management, and disaster recovery, designed for data extraction and attribute-based testing.",
  "diagramJson": {
    "nodes": [
      {
        "id": "step-1",
        "type": "step",
        "position": {
          "x": 50,
          "y": 135
        },
        "data": {
          "label": "1. Extract User Population",
          "description": "Extract the full population of database users and assigned roles for analysis.",
          "instructions": "# Extract Database User & Role Population\n\n## Objective\nObtain a complete and accurate list of all database users and their associated roles/permissions to serve as the basis for access testing.\n\n## Procedure\n1. **Connect to MCP/Data Source**: Navigate to the database management interface or use the provided API/connector.\n2. **Extract Population**: Run a query to extract all active and inactive users.\n   - **Attributes to Extract**:\n     - `User_ID` (Unique identifier)\n     - `User_Name`\n     - `Role_Assigned` (e.g., DBA, Read-Only, Developer)\n     - `Account_Status` (Active/Locked/Expired)\n     - `Last_Login_Date`\n     - `Created_Date`\n3. **Data Formatting**: Export the results to a structured format (CSV/XLSX) for sampling.\n\n## Expected Outputs\n- [ ] Full population file of database users.\n- [ ] Record count validation against system totals."
        },
        "width": 320,
        "height": 116
      },
      {
        "id": "step-2",
        "type": "step",
        "position": {
          "x": 450,
          "y": 50
        },
        "data": {
          "label": "2. Database Access Testing",
          "description": "Select a sample of users and verify access approvals and role appropriateness.",
          "instructions": "# Database Access Sample Testing\n\n## Objective\nConfirm that database access is role-based, formally approved, and aligned with the user's current job function.\n\n## Prerequisites\n- Completed User Population (Step 1).\n\n## Procedure\n1. **Sample Selection**: Using a statistical sampling tool or MCP's sampling module, select a sample of **X** users from the population.\n2. **Attribute Verification**: For each sampled user, inspect the following:\n   - **Access Request**: Locate the ticket or form (e.g., ServiceNow/Jira) showing the initial request.\n   - **Approval**: Verify the request was approved by the Data Owner or Manager.\n   - **Role Appropriateness**: Compare the `Role_Assigned` attribute against the user's Department/Job Title in HR records.\n3. **Document Exceptions**: Log any users with missing approvals or excessive roles.\n\n## Quality Criteria\n- Documentation must include the Request ID and the name of the Approver for every sample item."
        },
        "width": 320,
        "height": 116
      },
      {
        "id": "step-3",
        "type": "step",
        "position": {
          "x": 450,
          "y": 220
        },
        "data": {
          "label": "3. Privileged Access Review",
          "description": "Identify privileged users and verify business justification.",
          "instructions": "# Privileged Access Review\n\n## Objective\nRestrict and monitor privileged access (DBA, Superuser, Root) to prevent unauthorized changes or data exfiltration.\n\n## Procedure\n1. **Filter Population**: Identify all users from Step 1 with elevated privileges (e.g., `sysadmin`, `db_owner`, `SUPER`).\n2. **Verify Justification**:\n   - Extract the `Business_Justification` attribute from the access management system.\n   - Verify that privileged access is restricted to authorized IT administrators only.\n3. **Review Monitoring**: Inspect evidence that actions performed by these privileged accounts are logged and reviewed periodically.\n\n## Expected Outputs\n- [ ] List of privileged users with validated justifications.\n- [ ] Exception report for accounts with no clear business need for high-level access."
        },
        "width": 320,
        "height": 116
      },
      {
        "id": "step-4",
        "type": "step",
        "position": {
          "x": 50,
          "y": 305
        },
        "data": {
          "label": "4. Audit Database Changes",
          "description": "Audit database changes for approval, testing, and migration evidence.",
          "instructions": "# Database Change Control Audit\n\n## Objective\nEnsure all database schema or configuration changes are authorized, tested, and documented to maintain system integrity.\n\n## Procedure\n1. **Extract Change Logs**: Extract a list of all database changes (DDL/DML) for the audit period from the change management tool (MCP/Jira).\n   - **Attributes**: `Change_ID`, `Requestor`, `Approver`, `Date_of_Change`, `Environment` (Prod/UAT).\n2. **Sample Testing**: Select a sample of **X** changes and verify:\n   - **Approval**: Change was approved *before* implementation.\n   - **Testing**: Evidence of successful UAT (User Acceptance Testing) in a non-production environment.\n   - **Migration**: Verification that the change was migrated to production by an independent party (Segregation of Duties).\n\n## Quality Criteria\n- Evidence must show the separation between the developer and the person who migrated the change to production."
        },
        "width": 320,
        "height": 116
      },
      {
        "id": "step-5",
        "type": "step",
        "position": {
          "x": 50,
          "y": 475
        },
        "data": {
          "label": "5. Verify Database Backups",
          "description": "Verify successful database backups and adherence to retention policies.",
          "instructions": "# Backup Success & Retention Review\n\n## Objective\nConfirm that database backups are running successfully and that data is retained according to policy requirements.\n\n## Procedure\n1. **Extract Backup Logs**: Pull backup history logs for the last 30 days from the backup management system.\n   - **Attributes**: `Database_Name`, `Backup_Type` (Full/Inc), `Start_Time`, `End_Time`, `Status`, `Retention_Period`.\n2. **Analyze Status**:\n   - Filter for any \"Failed\" or \"Partial\" statuses.\n   - Verify that failures were investigated and resolved within 24 hours.\n3. **Check Retention**: Compare the `Retention_Period` attribute against the Corporate Data Retention Policy.\n\n## Expected Outputs\n- [ ] Backup Success Report.\n- [ ] Log of failed backups and remediation actions."
        },
        "width": 320,
        "height": 116
      },
      {
        "id": "step-6",
        "type": "step",
        "position": {
          "x": 450,
          "y": 475
        },
        "data": {
          "label": "6. Inspect Recovery Testing",
          "description": "Inspect evidence of periodic database recovery testing.",
          "instructions": "# Recovery Testing Inspection\n\n## Objective\nEnsure the organization can successfully restore the database from backups in the event of a disaster.\n\n## Prerequisites\n- Verified Backups (Step 5).\n\n## Procedure\n1. **Request Evidence**: Obtain the most recent \"Restore Test Report\" or \"DR Exercise Result.\"\n2. **Inspect Results**:\n   - Verify the date of the test is within the required frequency (e.g., Annual/Semi-annual).\n   - Confirm the test was successful and the data integrity was verified after the restore.\n   - Check if RTO (Recovery Time Objective) and RPO (Recovery Point Objective) targets were met.\n\n## Quality Criteria\n- Testing evidence must include a formal sign-off from the IT Director or DR Coordinator."
        },
        "width": 320,
        "height": 116
      }
    ],
    "edges": [
      {
        "id": "e1-2",
        "source": "step-1",
        "target": "step-2",
        "type": "deletable",
        "animated": true,
        "style": {
          "stroke": "#6366f1",
          "strokeWidth": 2,
          "strokeDasharray": "5,5"
        }
      },
      {
        "id": "e1-3",
        "source": "step-1",
        "target": "step-3",
        "type": "deletable",
        "animated": true,
        "style": {
          "stroke": "#6366f1",
          "strokeWidth": 2,
          "strokeDasharray": "5,5"
        }
      },
      {
        "id": "e5-6",
        "source": "step-5",
        "target": "step-6",
        "type": "deletable",
        "animated": true,
        "style": {
          "stroke": "#6366f1",
          "strokeWidth": 2,
          "strokeDasharray": "5,5"
        }
      }
    ],
    "metadata": {}
  }
}